(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47943,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var r={callServer:function(){return i.callServer},createServerReference:function(){return l.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}};for(var a in r)Object.defineProperty(s,a,{enumerable:!0,get:r[a]});let i=e.r(51395),n=e.r(5193),l=e.r(94204)},50212,e=>{"use strict";var t=e.i(81099),s=e.i(14499),r=e.i(47943),a=(0,r.createServerReference)("405c71b21c57040a5d956440b4eaa85f1b19b7bfe6",r.callServer,void 0,r.findSourceMapURL,"translateCrisis"),i=e.i(71727),n=e.i(77255);let l={primary:"bg-[var(--color-sky)] text-[var(--color-ink)] hover:bg-[color-mix(in_oklab,var(--color-sky),#ffffff_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sky)]",secondary:"bg-[var(--color-sage)] text-[var(--color-ink)] hover:bg-[color-mix(in_oklab,var(--color-sage),#ffffff_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sage)]",ghost:"bg-transparent text-[var(--body-foreground)] hover:bg-[rgba(126,156,203,0.1)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[rgba(126,156,203,0.4)]",subtle:"bg-white/70 text-[var(--body-foreground)] shadow-sm hover:bg-white focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sky)]",danger:"bg-[var(--color-danger)] text-white hover:bg-[color-mix(in_oklab,var(--color-danger),#000000_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-danger)]"},o={sm:"h-9 px-4 text-sm",md:"h-11 px-5 text-base",lg:"h-12 px-6 text-base"},c=s.forwardRef(({variant:e="primary",size:s="md",loading:r=!1,icon:a,className:i,disabled:c,children:d,...m},u)=>{let x=c||r;return(0,t.jsxs)("button",{ref:u,className:(0,n.cn)("inline-flex items-center justify-center gap-2 rounded-[var(--radius-pill)] font-semibold transition-all duration-200 ease-out shadow-[var(--shadow-soft)] disabled:cursor-not-allowed disabled:opacity-60 focus:outline-none",l[e],o[s],r&&"relative text-transparent",i),disabled:x,...m,children:[r&&(0,t.jsx)("span",{className:"absolute inline-flex h-full w-full items-center justify-center text-xs font-medium text-[var(--body-foreground)]",children:"Craftingâ€¦"}),!r&&a,(0,t.jsx)("span",{children:d})]})});c.displayName="Button";var d=e.i(20502),m=e.i(46932);function u({value:e,onChange:s}){let r=e/5*100,a=r/100*180,i=5===e?"#ef4444":4===e?"#f97316":3===e?"#f59e0b":2===e?"#3b82f6":"#10b981",n=180-a,l=128+112*Math.cos(n*Math.PI/180),o=128-112*Math.sin(n*Math.PI/180);return(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative w-64 h-32",children:[(0,t.jsx)("svg",{width:"256",height:"128",viewBox:"0 0 256 128",className:"absolute inset-0",children:(0,t.jsx)("path",{d:"M 16 112 A 112 112 0 0 1 240 112",fill:"none",stroke:"#e5e7eb",strokeWidth:"16",strokeLinecap:"round",className:"dark:stroke-gray-700"})}),(0,t.jsx)("svg",{width:"256",height:"128",viewBox:"0 0 256 128",className:"absolute inset-0",children:(0,t.jsx)(m.motion.path,{d:`M 16 128 A 112 112 0 ${+(a>180)} 1 ${l} ${o}`,fill:"none",stroke:i,strokeWidth:"16",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:r/100},transition:{duration:.5,ease:"easeOut"}})}),(0,t.jsx)(m.motion.div,{className:"absolute",style:{left:`${l/256*100}%`,top:`${o/128*100}%`,transform:"translate(-50%, -50%)",transformOrigin:"center"},animate:{left:`${l/256*100}%`,top:`${o/128*100}%`},transition:{duration:.5,ease:"easeOut"},children:(0,t.jsx)("div",{className:"w-0 h-0 border-l-[6px] border-r-[6px] border-t-[16px] border-l-transparent border-r-transparent",style:{borderTopColor:i}})}),(0,t.jsx)("div",{className:"absolute left-0 bottom-0 -translate-x-1/2",children:(0,t.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs",style:{backgroundColor:i},children:(0,t.jsx)("span",{className:"text-[10px]",children:"ðŸ’§"})})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-[var(--color-ink)] dark:text-white",children:"Stress"}),(0,t.jsxs)("span",{className:"text-2xl font-bold",style:{color:i},children:[e,"/5"]})]})]})}function x({steps:e,currentStep:s}){return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[e.map((e,r)=>{let a=void 0===s||s===e.stepNumber,i=void 0!==s&&s>e.stepNumber;return(0,t.jsxs)(m.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:a||i?1:.5,x:0},transition:{delay:.1*r},className:`
                flex items-start gap-3 p-3 rounded-lg
                ${a?"bg-indigo-50 dark:bg-indigo-900/20":i?"bg-gray-50 dark:bg-gray-800/50":"bg-white/50 dark:bg-gray-800/30"}
              `,children:[(0,t.jsx)("div",{className:`
                  w-10 h-10 rounded flex items-center justify-center
                  flex-shrink-0
                  ${a?"bg-indigo-600 text-white":i?"bg-gray-400 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}
                `,children:e.icon?(0,t.jsx)("span",{className:"text-base",children:e.icon}):(0,t.jsx)("span",{className:"text-sm font-bold",children:e.stepNumber})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("h3",{className:`
                  text-sm font-semibold mb-1
                  ${a?"text-indigo-900 dark:text-indigo-100":"text-gray-600 dark:text-gray-400"}
                `,children:["Step ",e.stepNumber," ",e.title]}),(0,t.jsx)("p",{className:`
                  text-xs leading-relaxed
                  ${a?"text-gray-800 dark:text-gray-200":"text-gray-600 dark:text-gray-400"}
                `,children:e.message})]}),i&&(0,t.jsx)(m.motion.div,{initial:{scale:0},animate:{scale:1},className:"w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center flex-shrink-0",children:"âœ“"})]},e.stepNumber)}),(0,t.jsx)("div",{className:"flex items-center justify-center gap-2 pt-2",children:e.map((e,r)=>(0,t.jsx)("div",{className:`
              w-2 h-2 rounded-full transition-all duration-200
              ${void 0===s||s===r+1?"bg-indigo-500 w-8":void 0!==s&&s>r+1?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}
            `},r))})]})}let h=[{id:"home",label:"Home",emoji:"ðŸ ",icon:"ðŸ ",description:"Safe, familiar space",color:"from-blue-400 to-blue-600"},{id:"school",label:"School",emoji:"ðŸ«",icon:"ðŸ«",description:"Academic environment",color:"from-purple-400 to-purple-600"},{id:"work",label:"Work",emoji:"ðŸ’¼",icon:"ðŸ’¼",description:"Professional setting",color:"from-indigo-400 to-indigo-600"},{id:"social",label:"Social",emoji:"ðŸ‘¥",icon:"ðŸ‘¥",description:"With friends or family",color:"from-pink-400 to-pink-600"},{id:"public",label:"Public",emoji:"ðŸŒ†",icon:"ðŸŒ†",description:"Public space",color:"from-gray-400 to-gray-600"},{id:"unknown",label:"Other",emoji:"ðŸ“",icon:"ðŸ“",description:"Different location",color:"from-slate-400 to-slate-600"}];function g({value:e,onChange:r,showLabel:a=!0}){let[i,n]=(0,s.useState)(e||"unknown"),[l,o]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e)n(e);else{let e=new Date().getHours(),t=new Date().getDay();e>=8&&e<=15&&t>=1&&t<=5?n("school"):e>=9&&e<=17&&t>=1&&t<=5?n("work"):n("home"),o(!0)}},[e]);let c=h.find(e=>e.id===i)||h[5];return(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[a&&(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"Where are you right now?"}),l&&(0,t.jsx)("span",{className:"text-xs text-[var(--color-muted)]",children:"Auto-detected"})]}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-3",children:h.map(e=>{let s=i===e.id;return(0,t.jsxs)(m.motion.button,{type:"button",onClick:()=>{var t;n(t=e.id),o(!1),r?.(t)},className:`
                flex flex-col items-center gap-2 p-3 rounded-xl
                transition-all duration-200
                focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500
                ${s?`bg-gradient-to-br ${e.color} text-white shadow-lg`:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}
              `,whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:[(0,t.jsx)("span",{className:"text-2xl",children:e.icon}),(0,t.jsx)("span",{className:`text-xs font-medium ${s?"text-white":""}`,children:e.label})]},e.id)})}),i&&(0,t.jsx)(m.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`
            rounded-lg p-3 text-sm
            bg-gradient-to-r ${c.color}
            text-white
          `,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg",children:c.icon}),(0,t.jsx)("span",{className:"font-medium",children:c.description})]})})]})}var p=e.i(24062),f=e.i(31178),b=e.i(47414),v=e.i(74008),y=e.i(21476),j=e.i(72846),N=s,k=e.i(37806);function w(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class S extends N.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,j.isHTMLElement)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function C({children:e,isPresent:r,anchorX:a,root:i}){let n=(0,N.useId)(),l=(0,N.useRef)(null),o=(0,N.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,N.useContext)(k.MotionConfigContext),d=function(...e){return s.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=w(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():w(e[t],null)}}}}(...e),e)}(l,e?.ref);return(0,N.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:d,right:m}=o.current;if(r||!l.current||!e||!t)return;let u="left"===a?`left: ${d}`:`right: ${m}`;l.current.dataset.motionPopId=n;let x=document.createElement("style");c&&(x.nonce=c);let h=i??document.head;return h.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${u}px !important;
            top: ${s}px !important;
          }
        `),()=>{h.contains(x)&&h.removeChild(x)}},[r]),(0,t.jsx)(S,{isPresent:r,childRef:l,sizeRef:o,children:N.cloneElement(e,{ref:d})})}let M=({children:e,initial:r,isPresent:a,onExitComplete:i,custom:n,presenceAffectsLayout:l,mode:o,anchorX:c,root:d})=>{let m=(0,b.useConstant)(L),u=(0,s.useId)(),x=!0,h=(0,s.useMemo)(()=>(x=!1,{id:u,initial:r,isPresent:a,custom:n,onExitComplete:e=>{for(let t of(m.set(e,!0),m.values()))if(!t)return;i&&i()},register:e=>(m.set(e,!1),()=>m.delete(e))}),[a,m,i]);return l&&x&&(h={...h}),(0,s.useMemo)(()=>{m.forEach((e,t)=>m.set(t,!1))},[a]),s.useEffect(()=>{a||m.size||!i||i()},[a]),"popLayout"===o&&(e=(0,t.jsx)(C,{isPresent:a,anchorX:c,root:d,children:e})),(0,t.jsx)(y.PresenceContext.Provider,{value:h,children:e})};function L(){return new Map}var T=e.i(64978);let $=e=>e.key||"";function E(e){let t=[];return s.Children.forEach(e,e=>{(0,s.isValidElement)(e)&&t.push(e)}),t}let R=({children:e,custom:r,initial:a=!0,onExitComplete:i,presenceAffectsLayout:n=!0,mode:l="sync",propagate:o=!1,anchorX:c="left",root:d})=>{let[m,u]=(0,T.usePresence)(o),x=(0,s.useMemo)(()=>E(e),[e]),h=o&&!m?[]:x.map($),g=(0,s.useRef)(!0),p=(0,s.useRef)(x),y=(0,b.useConstant)(()=>new Map),[j,N]=(0,s.useState)(x),[k,w]=(0,s.useState)(x);(0,v.useIsomorphicLayoutEffect)(()=>{g.current=!1,p.current=x;for(let e=0;e<k.length;e++){let t=$(k[e]);h.includes(t)?y.delete(t):!0!==y.get(t)&&y.set(t,!1)}},[k,h.length,h.join("-")]);let S=[];if(x!==j){let e=[...x];for(let t=0;t<k.length;t++){let s=k[t],r=$(s);h.includes(r)||(e.splice(t,0,s),S.push(s))}return"wait"===l&&S.length&&(e=S),w(E(e)),N(x),null}let{forceRender:C}=(0,s.useContext)(f.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:k.map(e=>{let s=$(e),f=(!o||!!m)&&(x===k||h.includes(s));return(0,t.jsx)(M,{isPresent:f,initial:(!g.current||!!a)&&void 0,custom:r,presenceAffectsLayout:n,mode:l,root:d,onExitComplete:f?void 0:()=>{if(!y.has(s))return;y.set(s,!0);let e=!0;y.forEach(t=>{t||(e=!1)}),e&&(C?.(),w(p.current),o&&u?.(),i&&i())},anchorX:c,children:e},s)})})},P=[{id:"box-breathing",name:"Box Breathing",description:"4-4-4-4 breathing pattern to regulate your nervous system",steps:["Inhale through your nose for 4 counts","Hold your breath for 4 counts","Exhale through your mouth for 4 counts","Hold for 4 counts","Repeat 4-6 times"],duration:"2-3 minutes",icon:"ðŸ«",color:"from-blue-400 to-blue-600",stressLevels:[3,4,5]},{id:"54321-grounding",name:"5-4-3-2-1 Grounding",description:"Use your senses to anchor yourself in the present moment",steps:["Name 5 things you can SEE","Name 4 things you can TOUCH","Name 3 things you can HEAR","Name 2 things you can SMELL","Name 1 thing you can TASTE"],duration:"2-3 minutes",icon:"ðŸŒ¿",color:"from-emerald-400 to-emerald-600",stressLevels:[2,3,4]},{id:"tipp-temperature",name:"Temperature Change (TIPP)",description:"Use temperature to quickly shift your body state",steps:["Splash cold water on your face","Or hold an ice cube in your hands","Or place a cold compress on your neck","Focus on the sensation for 30 seconds","Take 3 deep breaths"],duration:"1-2 minutes",icon:"â„ï¸",color:"from-cyan-400 to-cyan-600",stressLevels:[4,5]},{id:"progressive-muscle",name:"Progressive Muscle Relaxation",description:"Systematically tense and release muscle groups",steps:["Start with your toes - tense for 5 seconds, then release","Move to your calves - tense and release","Continue up your body: thighs, stomach, hands, arms, shoulders","Finish with your face - scrunch and release","Take 3 deep breaths"],duration:"5-10 minutes",icon:"ðŸ§˜",color:"from-purple-400 to-purple-600",stressLevels:[2,3,4]},{id:"mindful-movement",name:"Gentle Movement",description:"Use movement to release tension and regulate",steps:["Stand or sit comfortably","Slowly roll your shoulders back 5 times","Gently turn your head side to side","Stretch your arms overhead and hold for 10 seconds","Take 3 deep breaths"],duration:"2-3 minutes",icon:"ðŸ¤¸",color:"from-pink-400 to-pink-600",stressLevels:[1,2,3]}];function I({stressLevel:e,onSelect:s}){let r=P.filter(t=>t.stressLevels.includes(e));return 0===r.length?null:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white mb-1",children:"Suggested Calming Techniques"}),(0,t.jsx)("p",{className:"text-xs text-[var(--color-muted)]",children:"Evidence-based interventions for your current stress level"})]}),(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsx)(R,{mode:"wait",children:r.map((e,r)=>(0,t.jsx)(m.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:.1*r},className:`
                rounded-xl p-4 cursor-pointer
                bg-gradient-to-br ${e.color}
                text-white
                shadow-lg hover:shadow-xl
                transition-all duration-200
              `,onClick:()=>s?.(e),whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:"text-2xl",children:e.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("h4",{className:"font-semibold text-sm",children:e.name}),(0,t.jsx)("span",{className:"text-xs opacity-75",children:e.duration})]}),(0,t.jsx)("p",{className:"text-xs opacity-90 mb-2",children:e.description}),(0,t.jsxs)("ul",{className:"text-xs opacity-80 space-y-1",children:[e.steps.slice(0,3).map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"opacity-60",children:"â€¢"}),(0,t.jsx)("span",{children:e})]},s)),e.steps.length>3&&(0,t.jsxs)("li",{className:"text-xs opacity-60 italic",children:["+ ",e.steps.length-3," more steps"]})]})]})]})},e.id))})})]})}function A({stressLevel:e,recentTrend:r,timeOfDay:a,environment:n,onDismiss:l,onSendAlert:o}){let[u,x]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{x(e>=4||e>=3&&"increasing"===r)},[e,r]),!u)return null;let h=e>=5?"high":e>=4?"moderate":"low";return(0,t.jsx)(R,{children:(0,t.jsx)(m.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 right-4 left-4 md:left-auto md:w-96 z-50",children:(0,t.jsx)(i.SectionCard,{accent:"high"===h?"rose":"amber",className:"p-4 shadow-2xl border-2",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"text-3xl",children:"high"===h?"ðŸš¨":"âš ï¸"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-sm text-[var(--color-ink)] dark:text-white",children:"Predictive Alert"}),l&&(0,t.jsx)("button",{onClick:()=>{x(!1),l?.()},className:"text-[var(--color-muted)] hover:text-[var(--color-ink)] dark:hover:text-white",children:"âœ•"})]}),(0,t.jsx)("p",{className:"text-xs text-[var(--color-muted)] mb-3",children:"Stress escalation detected. Consider proactive intervention."}),(0,t.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Current Level:"}),(0,t.jsxs)(d.Badge,{className:"high"===h?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200":"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-200",children:[e,"/5"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Trend:"}),(0,t.jsx)("span",{className:"text-[var(--color-muted)] capitalize",children:r})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Environment:"}),(0,t.jsx)("span",{className:"text-[var(--color-muted)] capitalize",children:n})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[o&&(0,t.jsx)(c,{variant:"primary",size:"sm",onClick:()=>{o(),x(!1)},children:"Send Alert to Caregiver"}),(0,t.jsx)(c,{variant:"ghost",size:"sm",onClick:()=>x(!1),children:"Dismiss"})]})]})]})})})})}var U=(0,r.createServerReference)("4076abaad3a3aa2f1401a13f4b97972f263cb9ee18",r.callServer,void 0,r.findSourceMapURL,"sendCaregiverAlert");function _({profile:e,stressLevel:r,rawMessage:a,translationResult:i}){let[n,l]=(0,s.useTransition)(),[o,d]=(0,s.useState)({type:null,message:""}),m=e?.supportCircle?.filter(e=>"sms"===e.contactMethod&&e.phoneNumber)||[];return 0===m.length?(0,t.jsxs)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800 dark:border-amber-800 dark:bg-amber-900/20 dark:text-amber-200",children:[(0,t.jsx)("p",{className:"font-medium",children:"No SMS contacts configured"}),(0,t.jsx)("p",{className:"mt-1 text-xs opacity-75",children:"Add phone numbers to your support circle in your profile to enable caregiver alerts."})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"Send Alert to Caregiver"}),(0,t.jsx)("p",{className:"text-xs text-[var(--color-muted)] mt-1",children:"Notify your support circle about this situation"})]})}),(0,t.jsx)("div",{className:"flex flex-col gap-2",children:m.map(s=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-white/90 p-3 dark:bg-[rgba(15,23,42,0.75)]",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-[var(--color-ink)] dark:text-white",children:s.name}),(0,t.jsx)("p",{className:"text-xs text-[var(--color-muted)]",children:s.relationship})]}),(0,t.jsx)(c,{type:"button",variant:"primary",size:"sm",loading:n,onClick:()=>{var t,n;return t=s.phoneNumber,n=s.name,void(!t?d({type:"error",message:"No phone number provided for this contact"}):l(async()=>{let s={to:t,message:a,userName:e?.preferredName||"User",stressLevel:r,translatedMessage:i?.translatedMessage,groundingTechnique:i?.groundingTechnique,actionNeeded:r>=4?"High stress level detected. Immediate support recommended.":r>=3?"Moderate stress level. Check-in recommended.":void 0},l=await U(s);l.success?(d({type:"success",message:`Alert sent to ${n}!`}),setTimeout(()=>{d({type:null,message:""})},3e3)):d({type:"error",message:l.error||"Failed to send alert"})}))},disabled:n||!s.phoneNumber,children:"Send Alert"})]},`${s.name}-${s.relationship}`))}),o.type&&(0,t.jsx)("div",{className:`rounded-lg p-3 text-sm ${"success"===o.type?"bg-emerald-50 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-200":"bg-rose-50 text-rose-800 dark:bg-rose-900/20 dark:text-rose-200"}`,children:o.message})]})}let B=p.default.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:4000";class O extends Error{status;constructor(e,t){super(e),this.status=t,this.name="ApiError"}}async function H(e,t){let s=await fetch(`${B}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(!s.ok){let e=`API request failed: ${s.statusText}`;try{let t=await s.json();"string"==typeof t?.message&&(e=t.message)}catch{}throw new O(e,s.status)}return s.json()}async function q(e){return H(`/api/profiles/${e}`)}let z={stressLevel:3,environment:"unknown",rawMessage:"",triggers:"",safeSpace:"",calmingItem:"",communicationStyle:"",supportContext:""};function D(){let[e,r]=(0,s.useState)(z),[n,l]=(0,s.useState)({}),[o,m]=(0,s.useTransition)(),[h,p]=(0,s.useState)(null);s.default.useEffect(()=>{(async()=>{try{let e=localStorage.getItem("meltdown_userId");if(e){let t=await q(e);p(t)}}catch(e){console.warn("Could not load profile:",e)}})()},[]);let f=(0,s.useMemo)(()=>o||0===e.rawMessage.trim().length||e.stressLevel<1||e.stressLevel>5,[e,o]),b=(e,t)=>{r(s=>({...s,[e]:t}))},v=e.stressLevel>=4?"increasing":"stable";return(0,t.jsxs)("div",{className:"flex flex-col gap-8 pb-24",children:[(0,t.jsx)(A,{stressLevel:e.stressLevel,recentTrend:v,timeOfDay:new Date().getHours(),environment:e.environment,onSendAlert:()=>{h&&n.data&&console.log("Predictive alert: sending to caregivers")}}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)(d.Badge,{tone:"sage",className:"self-start",children:"Crisis Translator"}),(0,t.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-[var(--color-ink)] dark:text-white tracking-tight",children:"Grounded support, step by step."}),(0,t.jsx)("p",{className:"text-base leading-7 text-[var(--color-muted)] max-w-2xl",children:"Input how you're feeling and we'll craft a calm, structured plan your caregiver can follow."})]}),(0,t.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1fr_1fr]",children:[(0,t.jsxs)(i.SectionCard,{accent:"none",className:"gap-6 p-6 bg-white rounded-2xl shadow-lg dark:bg-[rgba(15,23,42,0.95)] backdrop-blur-sm",children:[(0,t.jsx)("div",{className:"flex flex-col gap-2",children:(0,t.jsx)("h2",{className:"text-lg font-semibold tracking-[-0.01em] text-[var(--color-ink)] dark:text-white",children:"Crisis Input"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 items-center py-4",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"How are you feeling right now?"}),(0,t.jsx)(u,{value:e.stressLevel,onChange:e=>b("stressLevel",e)})]}),(0,t.jsx)("div",{className:"flex flex-col gap-4",children:(0,t.jsx)(g,{value:e.environment,onChange:e=>b("environment",e),showLabel:!0})})]}),(0,t.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Raw message"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("textarea",{value:e.rawMessage,onChange:e=>b("rawMessage",e.target.value),rows:6,placeholder:"Tell us what's happening...",className:"w-full rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white p-4 text-sm text-[var(--color-ink)] shadow-sm transition-all focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200 dark:bg-[rgba(15,23,42,0.75)] dark:text-white dark:focus:border-indigo-400"}),(0,t.jsx)("button",{type:"button",className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Expand",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,t.jsxs)("div",{className:"hidden",children:[(0,t.jsx)("input",{value:e.triggers,onChange:e=>b("triggers",e.target.value),placeholder:"Triggers"}),(0,t.jsx)("input",{value:e.safeSpace,onChange:e=>b("safeSpace",e.target.value),placeholder:"Safe Space"}),(0,t.jsx)("input",{value:e.calmingItem,onChange:e=>b("calmingItem",e.target.value),placeholder:"Calming Item"}),(0,t.jsx)("input",{value:e.communicationStyle,onChange:e=>b("communicationStyle",e.target.value),placeholder:"Communication Style"}),(0,t.jsx)("textarea",{value:e.supportContext,onChange:e=>b("supportContext",e.target.value),placeholder:"Support Context"})]}),(0,t.jsx)(c,{type:"button",variant:"primary",loading:o,disabled:f,onClick:()=>{m(async()=>{try{let t={triggers:e.triggers.split(",").map(e=>e.trim()).filter(Boolean),safe_space:e.safeSpace,calming_item:e.calmingItem,communication_style:e.communicationStyle,support_network_context:e.supportContext},s=2*e.stressLevel,r=await a({stressLevel:s,rawMessage:e.rawMessage,aiProfile:t});l({data:r,error:void 0})}catch(e){console.error(e),l({data:void 0,error:e instanceof Error?e.message:"Something went wrong while translating your message. Please try again."})}})},className:"w-full py-3 text-base font-semibold bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg",children:"Translate to visual plan"}),n.error?(0,t.jsx)(i.SectionCard,{accent:"rose",className:"gap-2 border-dashed bg-[rgba(232,180,184,0.15)] text-sm text-[var(--color-rose)]",children:(0,t.jsx)("span",{children:n.error})}):null,e.stressLevel>=2&&(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-800",children:(0,t.jsx)(I,{stressLevel:e.stressLevel,onSelect:e=>{console.log("Selected technique:",e.name)}})})]}),(0,t.jsxs)(i.SectionCard,{accent:"sage",className:"gap-6 p-6 bg-white rounded-2xl shadow-lg dark:bg-[rgba(15,23,42,0.95)] backdrop-blur-sm",children:[(0,t.jsx)("div",{className:"flex flex-col gap-2 text-[var(--color-ink)] dark:text-white",children:(0,t.jsx)("h2",{className:"text-lg font-semibold tracking-[-0.01em]",children:"Recommended Output"})}),n.data?(0,t.jsxs)("div",{className:"flex flex-col gap-6 text-[var(--color-ink)] dark:text-white",children:[n.data.communicationMedium&&(0,t.jsxs)("div",{className:"pb-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-[rgba(17,24,39,0.55)] dark:text-[rgba(226,232,240,0.75)] mb-2",children:"Recommended Medium"}),(0,t.jsx)("p",{className:"text-base font-medium",children:n.data.communicationMedium})]}),(0,t.jsx)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-xl p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("span",{className:"text-sm",children:"ðŸ‘¥"})}),(0,t.jsx)("p",{className:"flex-1 text-sm leading-6 whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:n.data.translatedMessage})]})}),n.data.translatedMessage&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(x,{steps:[{stepNumber:1,title:"Open softly",message:n.data.translatedMessage.split(".")[0]||n.data.translatedMessage.substring(0,100),icon:"ðŸ›ï¸"},{stepNumber:2,title:"Name the need",message:n.data.groundingTechnique?.substring(0,80)||"Express what you need right now",icon:"ðŸ“¦"},{stepNumber:3,title:"Invite support",message:n.data.followUpSuggestion?.substring(0,80)||"Ask for what you need",icon:"âš™ï¸"}]})}),n.data.groundingTechnique&&(0,t.jsxs)("div",{className:"bg-sage-50 dark:bg-sage-900/20 rounded-xl p-4 border border-sage-200 dark:border-sage-800",children:[(0,t.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-[rgba(17,24,39,0.55)] dark:text-[rgba(226,232,240,0.75)] mb-2",children:"Grounding Technique"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.data.groundingTechnique})]}),n.data.safetyNote&&(0,t.jsx)(i.SectionCard,{accent:"rose",className:"gap-2 border-dashed bg-rose-50 dark:bg-rose-900/20 text-sm text-rose-800 dark:text-rose-200",children:n.data.safetyNote}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(c,{type:"button",variant:"ghost",onClick:()=>{r(z),l({})},className:"flex-1",children:"Reset"}),(0,t.jsx)(c,{type:"button",variant:"primary",className:"flex-1",onClick:()=>{n.data?.translatedMessage&&navigator.clipboard.writeText(n.data.translatedMessage)},children:"Save Visual Plan"})]}),n.data&&(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-800",children:(0,t.jsx)(_,{profile:h,stressLevel:e.stressLevel,rawMessage:e.rawMessage,translationResult:{translatedMessage:n.data.translatedMessage,communicationMedium:n.data.communicationMedium,groundingTechnique:n.data.groundingTechnique,followUpSuggestion:n.data.followUpSuggestion,safetyNote:n.data.safetyNote}})})]}):(0,t.jsxs)("div",{className:"text-center py-12 text-[var(--color-muted)]",children:[(0,t.jsx)("div",{className:"text-4xl mb-3",children:"ðŸ’¬"}),(0,t.jsx)("p",{className:"text-sm",children:"Your translated message and visual plan will appear here"})]})]})]})]})}e.s(["CrisisTranslatorForm",()=>D],50212)}]);