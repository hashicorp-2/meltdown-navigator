module.exports=[77112,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={ACTION_HMR_REFRESH:function(){return k},ACTION_NAVIGATE:function(){return h},ACTION_REFRESH:function(){return g},ACTION_RESTORE:function(){return i},ACTION_SERVER_ACTION:function(){return l},ACTION_SERVER_PATCH:function(){return j},PrefetchKind:function(){return m}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g="refresh",h="navigate",i="restore",j="server-patch",k="hmr-refresh",l="server-action";var m=((d={}).AUTO="auto",d.FULL="full",d.TEMPORARY="temporary",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},46058,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},96350,(a,b,c)=>{"use strict";function d(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isThenable",{enumerable:!0,get:function(){return d}})},13054,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={dispatchAppRouterAction:function(){return i},useActionQueue:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(46058)._(a.r(129)),g=a.r(96350),h=null;function i(a){if(null===h)throw Object.defineProperty(Error("Internal Next.js error: Router action dispatched before initialization."),"__NEXT_ERROR_CODE",{value:"E668",enumerable:!1,configurable:!0});h(a)}function j(a){let[b,c]=f.default.useState(a.state);h=b=>a.dispatch(b,c);let d=(0,f.useMemo)(()=>b,[b]);return(0,g.isThenable)(d)?(0,f.use)(d):d}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},18574,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"callServer",{enumerable:!0,get:function(){return g}});let d=a.r(129),e=a.r(77112),f=a.r(13054);async function g(a,b){return new Promise((c,g)=>{(0,d.startTransition)(()=>{(0,f.dispatchAppRouterAction)({type:e.ACTION_SERVER_ACTION,actionId:a,actionArgs:b,resolve:c,reject:g})})})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},76988,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"findSourceMapURL",{enumerable:!0,get:function(){return d}});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},97379,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(18574),g=a.r(76988),h=a.r(15239)},84585,a=>{"use strict";var b=a.i(9581),c=a.i(129),d=a.i(97379),e=(0,d.createServerReference)("405c71b21c57040a5d956440b4eaa85f1b19b7bfe6",d.callServer,void 0,d.findSourceMapURL,"translateCrisis"),f=a.i(3917),g=a.i(37503);let h={primary:"bg-[var(--color-sky)] text-[var(--color-ink)] hover:bg-[color-mix(in_oklab,var(--color-sky),#ffffff_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sky)]",secondary:"bg-[var(--color-sage)] text-[var(--color-ink)] hover:bg-[color-mix(in_oklab,var(--color-sage),#ffffff_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sage)]",ghost:"bg-transparent text-[var(--body-foreground)] hover:bg-[rgba(126,156,203,0.1)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[rgba(126,156,203,0.4)]",subtle:"bg-white/70 text-[var(--body-foreground)] shadow-sm hover:bg-white focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-sky)]",danger:"bg-[var(--color-danger)] text-white hover:bg-[color-mix(in_oklab,var(--color-danger),#000000_12%)] focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[var(--color-danger)]"},i={sm:"h-9 px-4 text-sm",md:"h-11 px-5 text-base",lg:"h-12 px-6 text-base"},j=c.forwardRef(({variant:a="primary",size:c="md",loading:d=!1,icon:e,className:f,disabled:j,children:k,...l},m)=>{let n=j||d;return(0,b.jsxs)("button",{ref:m,className:(0,g.cn)("inline-flex items-center justify-center gap-2 rounded-[var(--radius-pill)] font-semibold transition-all duration-200 ease-out shadow-[var(--shadow-soft)] disabled:cursor-not-allowed disabled:opacity-60 focus:outline-none",h[a],i[c],d&&"relative text-transparent",f),disabled:n,...l,children:[d&&(0,b.jsx)("span",{className:"absolute inline-flex h-full w-full items-center justify-center text-xs font-medium text-[var(--body-foreground)]",children:"Craftingâ€¦"}),!d&&e,(0,b.jsx)("span",{children:k})]})});j.displayName="Button";var k=a.i(66222),l=a.i(46271);function m({value:a,onChange:c}){let d=a/5*100,e=d/100*180,f=5===a?"#ef4444":4===a?"#f97316":3===a?"#f59e0b":2===a?"#3b82f6":"#10b981",g=180-e,h=128+112*Math.cos(g*Math.PI/180),i=128-112*Math.sin(g*Math.PI/180);return(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,b.jsxs)("div",{className:"relative w-64 h-32",children:[(0,b.jsx)("svg",{width:"256",height:"128",viewBox:"0 0 256 128",className:"absolute inset-0",children:(0,b.jsx)("path",{d:"M 16 112 A 112 112 0 0 1 240 112",fill:"none",stroke:"#e5e7eb",strokeWidth:"16",strokeLinecap:"round",className:"dark:stroke-gray-700"})}),(0,b.jsx)("svg",{width:"256",height:"128",viewBox:"0 0 256 128",className:"absolute inset-0",children:(0,b.jsx)(l.motion.path,{d:`M 16 128 A 112 112 0 ${+(e>180)} 1 ${h} ${i}`,fill:"none",stroke:f,strokeWidth:"16",strokeLinecap:"round",initial:{pathLength:0},animate:{pathLength:d/100},transition:{duration:.5,ease:"easeOut"}})}),(0,b.jsx)(l.motion.div,{className:"absolute",style:{left:`${h/256*100}%`,top:`${i/128*100}%`,transform:"translate(-50%, -50%)",transformOrigin:"center"},animate:{left:`${h/256*100}%`,top:`${i/128*100}%`},transition:{duration:.5,ease:"easeOut"},children:(0,b.jsx)("div",{className:"w-0 h-0 border-l-[6px] border-r-[6px] border-t-[16px] border-l-transparent border-r-transparent",style:{borderTopColor:f}})}),(0,b.jsx)("div",{className:"absolute left-0 bottom-0 -translate-x-1/2",children:(0,b.jsx)("div",{className:"w-5 h-5 rounded-full flex items-center justify-center text-xs",style:{backgroundColor:f},children:(0,b.jsx)("span",{className:"text-[10px]",children:"ðŸ’§"})})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-[var(--color-ink)] dark:text-white",children:"Stress"}),(0,b.jsxs)("span",{className:"text-2xl font-bold",style:{color:f},children:[a,"/5"]})]})]})}function n({steps:a,currentStep:c}){return(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[a.map((a,d)=>{let e=void 0===c||c===a.stepNumber,f=void 0!==c&&c>a.stepNumber;return(0,b.jsxs)(l.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:e||f?1:.5,x:0},transition:{delay:.1*d},className:`
                flex items-start gap-3 p-3 rounded-lg
                ${e?"bg-indigo-50 dark:bg-indigo-900/20":f?"bg-gray-50 dark:bg-gray-800/50":"bg-white/50 dark:bg-gray-800/30"}
              `,children:[(0,b.jsx)("div",{className:`
                  w-10 h-10 rounded flex items-center justify-center
                  flex-shrink-0
                  ${e?"bg-indigo-600 text-white":f?"bg-gray-400 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"}
                `,children:a.icon?(0,b.jsx)("span",{className:"text-base",children:a.icon}):(0,b.jsx)("span",{className:"text-sm font-bold",children:a.stepNumber})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("h3",{className:`
                  text-sm font-semibold mb-1
                  ${e?"text-indigo-900 dark:text-indigo-100":"text-gray-600 dark:text-gray-400"}
                `,children:["Step ",a.stepNumber," ",a.title]}),(0,b.jsx)("p",{className:`
                  text-xs leading-relaxed
                  ${e?"text-gray-800 dark:text-gray-200":"text-gray-600 dark:text-gray-400"}
                `,children:a.message})]}),f&&(0,b.jsx)(l.motion.div,{initial:{scale:0},animate:{scale:1},className:"w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center flex-shrink-0",children:"âœ“"})]},a.stepNumber)}),(0,b.jsx)("div",{className:"flex items-center justify-center gap-2 pt-2",children:a.map((a,d)=>(0,b.jsx)("div",{className:`
              w-2 h-2 rounded-full transition-all duration-200
              ${void 0===c||c===d+1?"bg-indigo-500 w-8":void 0!==c&&c>d+1?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}
            `},d))})]})}let o=[{id:"home",label:"Home",emoji:"ðŸ ",icon:"ðŸ ",description:"Safe, familiar space",color:"from-blue-400 to-blue-600"},{id:"school",label:"School",emoji:"ðŸ«",icon:"ðŸ«",description:"Academic environment",color:"from-purple-400 to-purple-600"},{id:"work",label:"Work",emoji:"ðŸ’¼",icon:"ðŸ’¼",description:"Professional setting",color:"from-indigo-400 to-indigo-600"},{id:"social",label:"Social",emoji:"ðŸ‘¥",icon:"ðŸ‘¥",description:"With friends or family",color:"from-pink-400 to-pink-600"},{id:"public",label:"Public",emoji:"ðŸŒ†",icon:"ðŸŒ†",description:"Public space",color:"from-gray-400 to-gray-600"},{id:"unknown",label:"Other",emoji:"ðŸ“",icon:"ðŸ“",description:"Different location",color:"from-slate-400 to-slate-600"}];function p({value:a,onChange:d,showLabel:e=!0}){let[f,g]=(0,c.useState)(a||"unknown"),[h,i]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a)g(a);else{let a=new Date().getHours(),b=new Date().getDay();a>=8&&a<=15&&b>=1&&b<=5?g("school"):a>=9&&a<=17&&b>=1&&b<=5?g("work"):g("home"),i(!0)}},[a]);let j=o.find(a=>a.id===f)||o[5];return(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[e&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"Where are you right now?"}),h&&(0,b.jsx)("span",{className:"text-xs text-[var(--color-muted)]",children:"Auto-detected"})]}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-3",children:o.map(a=>{let c=f===a.id;return(0,b.jsxs)(l.motion.button,{type:"button",onClick:()=>{var b;g(b=a.id),i(!1),d?.(b)},className:`
                flex flex-col items-center gap-2 p-3 rounded-xl
                transition-all duration-200
                focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500
                ${c?`bg-gradient-to-br ${a.color} text-white shadow-lg`:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}
              `,whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:[(0,b.jsx)("span",{className:"text-2xl",children:a.icon}),(0,b.jsx)("span",{className:`text-xs font-medium ${c?"text-white":""}`,children:a.label})]},a.id)})}),f&&(0,b.jsx)(l.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:`
            rounded-lg p-3 text-sm
            bg-gradient-to-r ${j.color}
            text-white
          `,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-lg",children:j.icon}),(0,b.jsx)("span",{className:"font-medium",children:j.description})]})})]})}var q=a.i(86723),r=a.i(74290),s=a.i(1703),t=a.i(11987),u=a.i(91128),v=c,w=a.i(65802);function x(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class y extends v.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,u.isHTMLElement)(a)&&a.offsetWidth||0,d=this.props.sizeRef.current;d.height=b.offsetHeight||0,d.width=b.offsetWidth||0,d.top=b.offsetTop,d.left=b.offsetLeft,d.right=c-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function z({children:a,isPresent:d,anchorX:e,root:f}){let g=(0,v.useId)(),h=(0,v.useRef)(null),i=(0,v.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:j}=(0,v.useContext)(w.MotionConfigContext),k=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=x(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():x(a[b],null)}}}}(...a),a)}(h,a?.ref);return(0,v.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:k,right:l}=i.current;if(d||!h.current||!a||!b)return;let m="left"===e?`left: ${k}`:`right: ${l}`;h.current.dataset.motionPopId=g;let n=document.createElement("style");j&&(n.nonce=j);let o=f??document.head;return o.appendChild(n),n.sheet&&n.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${m}px !important;
            top: ${c}px !important;
          }
        `),()=>{o.contains(n)&&o.removeChild(n)}},[d]),(0,b.jsx)(y,{isPresent:d,childRef:h,sizeRef:i,children:v.cloneElement(a,{ref:k})})}let A=({children:a,initial:d,isPresent:e,onExitComplete:f,custom:g,presenceAffectsLayout:h,mode:i,anchorX:j,root:k})=>{let l=(0,r.useConstant)(B),m=(0,c.useId)(),n=!0,o=(0,c.useMemo)(()=>(n=!1,{id:m,initial:d,isPresent:e,custom:g,onExitComplete:a=>{for(let b of(l.set(a,!0),l.values()))if(!b)return;f&&f()},register:a=>(l.set(a,!1),()=>l.delete(a))}),[e,l,f]);return h&&n&&(o={...o}),(0,c.useMemo)(()=>{l.forEach((a,b)=>l.set(b,!1))},[e]),c.useEffect(()=>{e||l.size||!f||f()},[e]),"popLayout"===i&&(a=(0,b.jsx)(z,{isPresent:e,anchorX:j,root:k,children:a})),(0,b.jsx)(t.PresenceContext.Provider,{value:o,children:a})};function B(){return new Map}var C=a.i(20410);let D=a=>a.key||"";function E(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let F=({children:a,custom:d,initial:e=!0,onExitComplete:f,presenceAffectsLayout:g=!0,mode:h="sync",propagate:i=!1,anchorX:j="left",root:k})=>{let[l,m]=(0,C.usePresence)(i),n=(0,c.useMemo)(()=>E(a),[a]),o=i&&!l?[]:n.map(D),p=(0,c.useRef)(!0),t=(0,c.useRef)(n),u=(0,r.useConstant)(()=>new Map),[v,w]=(0,c.useState)(n),[x,y]=(0,c.useState)(n);(0,s.useIsomorphicLayoutEffect)(()=>{p.current=!1,t.current=n;for(let a=0;a<x.length;a++){let b=D(x[a]);o.includes(b)?u.delete(b):!0!==u.get(b)&&u.set(b,!1)}},[x,o.length,o.join("-")]);let z=[];if(n!==v){let a=[...n];for(let b=0;b<x.length;b++){let c=x[b],d=D(c);o.includes(d)||(a.splice(b,0,c),z.push(c))}return"wait"===h&&z.length&&(a=z),y(E(a)),w(n),null}let{forceRender:B}=(0,c.useContext)(q.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:x.map(a=>{let c=D(a),q=(!i||!!l)&&(n===x||o.includes(c));return(0,b.jsx)(A,{isPresent:q,initial:(!p.current||!!e)&&void 0,custom:d,presenceAffectsLayout:g,mode:h,root:k,onExitComplete:q?void 0:()=>{if(!u.has(c))return;u.set(c,!0);let a=!0;u.forEach(b=>{b||(a=!1)}),a&&(B?.(),y(t.current),i&&m?.(),f&&f())},anchorX:j,children:a},c)})})},G=[{id:"box-breathing",name:"Box Breathing",description:"4-4-4-4 breathing pattern to regulate your nervous system",steps:["Inhale through your nose for 4 counts","Hold your breath for 4 counts","Exhale through your mouth for 4 counts","Hold for 4 counts","Repeat 4-6 times"],duration:"2-3 minutes",icon:"ðŸ«",color:"from-blue-400 to-blue-600",stressLevels:[3,4,5]},{id:"54321-grounding",name:"5-4-3-2-1 Grounding",description:"Use your senses to anchor yourself in the present moment",steps:["Name 5 things you can SEE","Name 4 things you can TOUCH","Name 3 things you can HEAR","Name 2 things you can SMELL","Name 1 thing you can TASTE"],duration:"2-3 minutes",icon:"ðŸŒ¿",color:"from-emerald-400 to-emerald-600",stressLevels:[2,3,4]},{id:"tipp-temperature",name:"Temperature Change (TIPP)",description:"Use temperature to quickly shift your body state",steps:["Splash cold water on your face","Or hold an ice cube in your hands","Or place a cold compress on your neck","Focus on the sensation for 30 seconds","Take 3 deep breaths"],duration:"1-2 minutes",icon:"â„ï¸",color:"from-cyan-400 to-cyan-600",stressLevels:[4,5]},{id:"progressive-muscle",name:"Progressive Muscle Relaxation",description:"Systematically tense and release muscle groups",steps:["Start with your toes - tense for 5 seconds, then release","Move to your calves - tense and release","Continue up your body: thighs, stomach, hands, arms, shoulders","Finish with your face - scrunch and release","Take 3 deep breaths"],duration:"5-10 minutes",icon:"ðŸ§˜",color:"from-purple-400 to-purple-600",stressLevels:[2,3,4]},{id:"mindful-movement",name:"Gentle Movement",description:"Use movement to release tension and regulate",steps:["Stand or sit comfortably","Slowly roll your shoulders back 5 times","Gently turn your head side to side","Stretch your arms overhead and hold for 10 seconds","Take 3 deep breaths"],duration:"2-3 minutes",icon:"ðŸ¤¸",color:"from-pink-400 to-pink-600",stressLevels:[1,2,3]}];function H({stressLevel:a,onSelect:c}){let d=G.filter(b=>b.stressLevels.includes(a));return 0===d.length?null:(0,b.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white mb-1",children:"Suggested Calming Techniques"}),(0,b.jsx)("p",{className:"text-xs text-[var(--color-muted)]",children:"Evidence-based interventions for your current stress level"})]}),(0,b.jsx)("div",{className:"flex flex-col gap-3",children:(0,b.jsx)(F,{mode:"wait",children:d.map((a,d)=>(0,b.jsx)(l.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:.1*d},className:`
                rounded-xl p-4 cursor-pointer
                bg-gradient-to-br ${a.color}
                text-white
                shadow-lg hover:shadow-xl
                transition-all duration-200
              `,onClick:()=>c?.(a),whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("span",{className:"text-2xl",children:a.icon}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("h4",{className:"font-semibold text-sm",children:a.name}),(0,b.jsx)("span",{className:"text-xs opacity-75",children:a.duration})]}),(0,b.jsx)("p",{className:"text-xs opacity-90 mb-2",children:a.description}),(0,b.jsxs)("ul",{className:"text-xs opacity-80 space-y-1",children:[a.steps.slice(0,3).map((a,c)=>(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"opacity-60",children:"â€¢"}),(0,b.jsx)("span",{children:a})]},c)),a.steps.length>3&&(0,b.jsxs)("li",{className:"text-xs opacity-60 italic",children:["+ ",a.steps.length-3," more steps"]})]})]})]})},a.id))})})]})}function I({stressLevel:a,recentTrend:d,timeOfDay:e,environment:g,onDismiss:h,onSendAlert:i}){let[m,n]=(0,c.useState)(!1);if((0,c.useEffect)(()=>{n(a>=4||a>=3&&"increasing"===d)},[a,d]),!m)return null;let o=a>=5?"high":a>=4?"moderate":"low";return(0,b.jsx)(F,{children:(0,b.jsx)(l.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"fixed top-4 right-4 left-4 md:left-auto md:w-96 z-50",children:(0,b.jsx)(f.SectionCard,{accent:"high"===o?"rose":"amber",className:"p-4 shadow-2xl border-2",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"text-3xl",children:"high"===o?"ðŸš¨":"âš ï¸"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h3",{className:"font-semibold text-sm text-[var(--color-ink)] dark:text-white",children:"Predictive Alert"}),h&&(0,b.jsx)("button",{onClick:()=>{n(!1),h?.()},className:"text-[var(--color-muted)] hover:text-[var(--color-ink)] dark:hover:text-white",children:"âœ•"})]}),(0,b.jsx)("p",{className:"text-xs text-[var(--color-muted)] mb-3",children:"Stress escalation detected. Consider proactive intervention."}),(0,b.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,b.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Current Level:"}),(0,b.jsxs)(k.Badge,{className:"high"===o?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-200":"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-200",children:[a,"/5"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,b.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Trend:"}),(0,b.jsx)("span",{className:"text-[var(--color-muted)] capitalize",children:d})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,b.jsx)("span",{className:"font-medium text-[var(--color-ink)] dark:text-white",children:"Environment:"}),(0,b.jsx)("span",{className:"text-[var(--color-muted)] capitalize",children:g})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[i&&(0,b.jsx)(j,{variant:"primary",size:"sm",onClick:()=>{i(),n(!1)},children:"Send Alert to Caregiver"}),(0,b.jsx)(j,{variant:"ghost",size:"sm",onClick:()=>n(!1),children:"Dismiss"})]})]})]})})})})}var J=(0,d.createServerReference)("4076abaad3a3aa2f1401a13f4b97972f263cb9ee18",d.callServer,void 0,d.findSourceMapURL,"sendCaregiverAlert");function K({profile:a,stressLevel:d,rawMessage:e,translationResult:f}){let[g,h]=(0,c.useTransition)(),[i,k]=(0,c.useState)({type:null,message:""}),l=a?.supportCircle?.filter(a=>"sms"===a.contactMethod&&a.phoneNumber)||[];return 0===l.length?(0,b.jsxs)("div",{className:"rounded-lg border border-amber-200 bg-amber-50 p-4 text-sm text-amber-800 dark:border-amber-800 dark:bg-amber-900/20 dark:text-amber-200",children:[(0,b.jsx)("p",{className:"font-medium",children:"No SMS contacts configured"}),(0,b.jsx)("p",{className:"mt-1 text-xs opacity-75",children:"Add phone numbers to your support circle in your profile to enable caregiver alerts."})]}):(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"Send Alert to Caregiver"}),(0,b.jsx)("p",{className:"text-xs text-[var(--color-muted)] mt-1",children:"Notify your support circle about this situation"})]})}),(0,b.jsx)("div",{className:"flex flex-col gap-2",children:l.map(c=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-white/90 p-3 dark:bg-[rgba(15,23,42,0.75)]",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-[var(--color-ink)] dark:text-white",children:c.name}),(0,b.jsx)("p",{className:"text-xs text-[var(--color-muted)]",children:c.relationship})]}),(0,b.jsx)(j,{type:"button",variant:"primary",size:"sm",loading:g,onClick:()=>{var b,g;return b=c.phoneNumber,g=c.name,void(!b?k({type:"error",message:"No phone number provided for this contact"}):h(async()=>{let c={to:b,message:e,userName:a?.preferredName||"User",stressLevel:d,translatedMessage:f?.translatedMessage,groundingTechnique:f?.groundingTechnique,actionNeeded:d>=4?"High stress level detected. Immediate support recommended.":d>=3?"Moderate stress level. Check-in recommended.":void 0},h=await J(c);h.success?(k({type:"success",message:`Alert sent to ${g}!`}),setTimeout(()=>{k({type:null,message:""})},3e3)):k({type:"error",message:h.error||"Failed to send alert"})}))},disabled:g||!c.phoneNumber,children:"Send Alert"})]},`${c.name}-${c.relationship}`))}),i.type&&(0,b.jsx)("div",{className:`rounded-lg p-3 text-sm ${"success"===i.type?"bg-emerald-50 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-200":"bg-rose-50 text-rose-800 dark:bg-rose-900/20 dark:text-rose-200"}`,children:i.message})]})}let L=process.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:4000";class M extends Error{status;constructor(a,b){super(a),this.status=b,this.name="ApiError"}}async function N(a,b){let c=await fetch(`${L}${a}`,{...b,headers:{"Content-Type":"application/json",...b?.headers}});if(!c.ok){let a=`API request failed: ${c.statusText}`;try{let b=await c.json();"string"==typeof b?.message&&(a=b.message)}catch{}throw new M(a,c.status)}return c.json()}async function O(a){return N(`/api/profiles/${a}`)}let P={stressLevel:3,environment:"unknown",rawMessage:"",triggers:"",safeSpace:"",calmingItem:"",communicationStyle:"",supportContext:""};function Q(){let[a,d]=(0,c.useState)(P),[g,h]=(0,c.useState)({}),[i,l]=(0,c.useTransition)(),[o,q]=(0,c.useState)(null);c.default.useEffect(()=>{(async()=>{try{let a=localStorage.getItem("meltdown_userId");if(a){let b=await O(a);q(b)}}catch(a){console.warn("Could not load profile:",a)}})()},[]);let r=(0,c.useMemo)(()=>i||0===a.rawMessage.trim().length||a.stressLevel<1||a.stressLevel>5,[a,i]),s=(a,b)=>{d(c=>({...c,[a]:b}))},t=a.stressLevel>=4?"increasing":"stable";return(0,b.jsxs)("div",{className:"flex flex-col gap-8 pb-24",children:[(0,b.jsx)(I,{stressLevel:a.stressLevel,recentTrend:t,timeOfDay:new Date().getHours(),environment:a.environment,onSendAlert:()=>{o&&g.data&&console.log("Predictive alert: sending to caregivers")}}),(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,b.jsx)(k.Badge,{tone:"sage",className:"self-start",children:"Crisis Translator"}),(0,b.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-[var(--color-ink)] dark:text-white tracking-tight",children:"Grounded support, step by step."}),(0,b.jsx)("p",{className:"text-base leading-7 text-[var(--color-muted)] max-w-2xl",children:"Input how you're feeling and we'll craft a calm, structured plan your caregiver can follow."})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1fr_1fr]",children:[(0,b.jsxs)(f.SectionCard,{accent:"none",className:"gap-6 p-6 bg-white rounded-2xl shadow-lg dark:bg-[rgba(15,23,42,0.95)] backdrop-blur-sm",children:[(0,b.jsx)("div",{className:"flex flex-col gap-2",children:(0,b.jsx)("h2",{className:"text-lg font-semibold tracking-[-0.01em] text-[var(--color-ink)] dark:text-white",children:"Crisis Input"})}),(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 items-center py-4",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-[var(--color-ink)] dark:text-white",children:"How are you feeling right now?"}),(0,b.jsx)(m,{value:a.stressLevel,onChange:a=>s("stressLevel",a)})]}),(0,b.jsx)("div",{className:"flex flex-col gap-4",children:(0,b.jsx)(p,{value:a.environment,onChange:a=>s("environment",a),showLabel:!0})})]}),(0,b.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Raw message"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("textarea",{value:a.rawMessage,onChange:a=>s("rawMessage",a.target.value),rows:6,placeholder:"Tell us what's happening...",className:"w-full rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-white p-4 text-sm text-[var(--color-ink)] shadow-sm transition-all focus:border-indigo-500 focus:outline-none focus:ring-2 focus:ring-indigo-200 dark:bg-[rgba(15,23,42,0.75)] dark:text-white dark:focus:border-indigo-400"}),(0,b.jsx)("button",{type:"button",className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300","aria-label":"Expand",children:(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,b.jsxs)("div",{className:"hidden",children:[(0,b.jsx)("input",{value:a.triggers,onChange:a=>s("triggers",a.target.value),placeholder:"Triggers"}),(0,b.jsx)("input",{value:a.safeSpace,onChange:a=>s("safeSpace",a.target.value),placeholder:"Safe Space"}),(0,b.jsx)("input",{value:a.calmingItem,onChange:a=>s("calmingItem",a.target.value),placeholder:"Calming Item"}),(0,b.jsx)("input",{value:a.communicationStyle,onChange:a=>s("communicationStyle",a.target.value),placeholder:"Communication Style"}),(0,b.jsx)("textarea",{value:a.supportContext,onChange:a=>s("supportContext",a.target.value),placeholder:"Support Context"})]}),(0,b.jsx)(j,{type:"button",variant:"primary",loading:i,disabled:r,onClick:()=>{l(async()=>{try{let b={triggers:a.triggers.split(",").map(a=>a.trim()).filter(Boolean),safe_space:a.safeSpace,calming_item:a.calmingItem,communication_style:a.communicationStyle,support_network_context:a.supportContext},c=2*a.stressLevel,d=await e({stressLevel:c,rawMessage:a.rawMessage,aiProfile:b});h({data:d,error:void 0})}catch(a){console.error(a),h({data:void 0,error:a instanceof Error?a.message:"Something went wrong while translating your message. Please try again."})}})},className:"w-full py-3 text-base font-semibold bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl shadow-lg",children:"Translate to visual plan"}),g.error?(0,b.jsx)(f.SectionCard,{accent:"rose",className:"gap-2 border-dashed bg-[rgba(232,180,184,0.15)] text-sm text-[var(--color-rose)]",children:(0,b.jsx)("span",{children:g.error})}):null,a.stressLevel>=2&&(0,b.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-800",children:(0,b.jsx)(H,{stressLevel:a.stressLevel,onSelect:a=>{console.log("Selected technique:",a.name)}})})]}),(0,b.jsxs)(f.SectionCard,{accent:"sage",className:"gap-6 p-6 bg-white rounded-2xl shadow-lg dark:bg-[rgba(15,23,42,0.95)] backdrop-blur-sm",children:[(0,b.jsx)("div",{className:"flex flex-col gap-2 text-[var(--color-ink)] dark:text-white",children:(0,b.jsx)("h2",{className:"text-lg font-semibold tracking-[-0.01em]",children:"Recommended Output"})}),g.data?(0,b.jsxs)("div",{className:"flex flex-col gap-6 text-[var(--color-ink)] dark:text-white",children:[g.data.communicationMedium&&(0,b.jsxs)("div",{className:"pb-4 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-[rgba(17,24,39,0.55)] dark:text-[rgba(226,232,240,0.75)] mb-2",children:"Recommended Medium"}),(0,b.jsx)("p",{className:"text-base font-medium",children:g.data.communicationMedium})]}),(0,b.jsx)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-xl p-4",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)("span",{className:"text-sm",children:"ðŸ‘¥"})}),(0,b.jsx)("p",{className:"flex-1 text-sm leading-6 whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:g.data.translatedMessage})]})}),g.data.translatedMessage&&(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(n,{steps:[{stepNumber:1,title:"Open softly",message:g.data.translatedMessage.split(".")[0]||g.data.translatedMessage.substring(0,100),icon:"ðŸ›ï¸"},{stepNumber:2,title:"Name the need",message:g.data.groundingTechnique?.substring(0,80)||"Express what you need right now",icon:"ðŸ“¦"},{stepNumber:3,title:"Invite support",message:g.data.followUpSuggestion?.substring(0,80)||"Ask for what you need",icon:"âš™ï¸"}]})}),g.data.groundingTechnique&&(0,b.jsxs)("div",{className:"bg-sage-50 dark:bg-sage-900/20 rounded-xl p-4 border border-sage-200 dark:border-sage-800",children:[(0,b.jsx)("h3",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-[rgba(17,24,39,0.55)] dark:text-[rgba(226,232,240,0.75)] mb-2",children:"Grounding Technique"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:g.data.groundingTechnique})]}),g.data.safetyNote&&(0,b.jsx)(f.SectionCard,{accent:"rose",className:"gap-2 border-dashed bg-rose-50 dark:bg-rose-900/20 text-sm text-rose-800 dark:text-rose-200",children:g.data.safetyNote}),(0,b.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,b.jsx)(j,{type:"button",variant:"ghost",onClick:()=>{d(P),h({})},className:"flex-1",children:"Reset"}),(0,b.jsx)(j,{type:"button",variant:"primary",className:"flex-1",onClick:()=>{g.data?.translatedMessage&&navigator.clipboard.writeText(g.data.translatedMessage)},children:"Save Visual Plan"})]}),g.data&&(0,b.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-800",children:(0,b.jsx)(K,{profile:o,stressLevel:a.stressLevel,rawMessage:a.rawMessage,translationResult:{translatedMessage:g.data.translatedMessage,communicationMedium:g.data.communicationMedium,groundingTechnique:g.data.groundingTechnique,followUpSuggestion:g.data.followUpSuggestion,safetyNote:g.data.safetyNote}})})]}):(0,b.jsxs)("div",{className:"text-center py-12 text-[var(--color-muted)]",children:[(0,b.jsx)("div",{className:"text-4xl mb-3",children:"ðŸ’¬"}),(0,b.jsx)("p",{className:"text-sm",children:"Your translated message and visual plan will appear here"})]})]})]})]})}a.s(["CrisisTranslatorForm",()=>Q],84585)}];

//# sourceMappingURL=_bf272d97._.js.map