(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96086,(e,s,t)=>{s.exports=e.r(9187)},90723,e=>{"use strict";var s=e.i(48277),t=e.i(30668),i=e.i(96086),l=e.i(1831),a=e.i(98989),n=e.i(35691),r=e.i(53938);let o={preferredName:"",supportCircle:[],communicationGuidelines:{tone:"soft",doPhrases:[],avoidPhrases:[]},crisisSignals:{triggers:[],escalationIndicators:[],selfRegulationTechniques:[]}},c=["Welcome","Support Circle","Communication Style","Crisis Signals","Review"];function d({userId:e,onComplete:i,onCancel:d}){let[g,f]=(0,t.useState)(1),[j,b]=(0,t.useState)(o),[N,v]=(0,t.useTransition)(),[y,C]=(0,t.useState)(null),S=(e,s)=>{b(t=>({...t,[e]:s}))},w=()=>{switch(g){case 1:return j.preferredName.trim().length>0;case 2:case 3:case 4:return!0;case 5:return!N;default:return!1}};return(0,s.jsx)("div",{className:"mx-auto max-w-2xl px-6 pb-24",children:(0,s.jsxs)("div",{className:"rounded-4xl bg-white/80 p-8 shadow-2xl shadow-indigo-100 backdrop-blur-xl",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:c.map((e,t)=>{let i=t+1,l=i===g,a=i<g;return(0,s.jsxs)("div",{className:"flex flex-1 items-center",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)("div",{className:`flex size-10 items-center justify-center rounded-full text-sm font-semibold transition ${l?"bg-indigo-500 text-white":a?"bg-indigo-200 text-indigo-700":"bg-slate-200 text-slate-500"}`,children:a?"✓":i}),(0,s.jsx)("span",{className:`text-xs font-medium ${l?"text-indigo-600":"text-slate-500"}`,children:e})]}),t<c.length-1&&(0,s.jsx)("div",{className:`mx-2 h-1 flex-1 rounded ${a?"bg-indigo-500":"bg-slate-200"}`})]},i)})})}),(0,s.jsx)(r.AnimatePresence,{mode:"wait",children:(0,s.jsx)(n.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:(()=>{switch(g){case 1:return(0,s.jsx)(m,{formData:j,updateFormData:S});case 2:return(0,s.jsx)(x,{formData:j,updateFormData:S});case 3:return(0,s.jsx)(u,{formData:j,updateFormData:S});case 4:return(0,s.jsx)(h,{formData:j,updateFormData:S});case 5:return(0,s.jsx)(p,{formData:j});default:return null}})()},g)}),y&&(0,s.jsx)("div",{className:"mt-6 rounded-lg bg-rose-50 p-4 text-sm text-rose-600",children:y}),(0,s.jsxs)("div",{className:"mt-8 flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[g>1&&(0,s.jsx)(a.FocusButton,{variant:"secondary",onClick:()=>{g>1&&(f(e=>e-1),C(null))},disabled:N,children:"Previous"}),d&&1===g&&(0,s.jsx)(a.FocusButton,{variant:"secondary",onClick:d,disabled:N,children:"Cancel"})]}),(0,s.jsx)("div",{className:"flex gap-4",children:g<5?(0,s.jsx)(a.FocusButton,{onClick:()=>{g<5&&(f(e=>e+1),C(null))},disabled:!w()||N,glow:!0,children:"Next"}):(0,s.jsx)(a.FocusButton,{onClick:()=>{v(async()=>{try{C(null);let s={userId:e,preferredName:j.preferredName,supportCircle:j.supportCircle,communicationGuidelines:j.communicationGuidelines,crisisSignals:j.crisisSignals},t=await (0,l.createProfile)(s);i(t)}catch(e){console.error(e),C(e instanceof Error?e.message:"Failed to create profile. Please try again.")}})},disabled:!w()||N,glow:!0,children:N?"Creating...":"Create Profile"})})]})]})})}function m({formData:e,updateFormData:t}){return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Welcome to Meltdown Navigator"}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"Let's create your personalized AI profile. This will help us provide tailored support during difficult moments."})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"What should we call you?"}),(0,s.jsx)("input",{type:"text",value:e.preferredName,onChange:e=>t("preferredName",e.target.value),placeholder:"Your name",className:"rounded-3xl border border-slate-200 bg-slate-50 px-4 py-3 text-base text-slate-700 shadow-inner focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200",autoFocus:!0})]})]})}function x({formData:e,updateFormData:i}){let[l,n]=(0,t.useState)({name:"",relationship:"",contactMethod:"sms"});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Support Circle"}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"Add people in your support network (up to 5). This helps us tailor communication recommendations."})]}),e.supportCircle.length>0&&(0,s.jsx)("div",{className:"space-y-3",children:e.supportCircle.map((t,l)=>(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-2xl bg-indigo-50 p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-slate-900",children:t.name}),(0,s.jsxs)("p",{className:"text-sm text-slate-600",children:[t.relationship," • ",t.contactMethod]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>{i("supportCircle",e.supportCircle.filter((e,s)=>s!==l))},className:"rounded-full bg-rose-100 px-3 py-1 text-sm font-medium text-rose-600 transition hover:bg-rose-200",children:"Remove"})]},l))}),e.supportCircle.length<5&&(0,s.jsxs)("div",{className:"space-y-4 rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Name"}),(0,s.jsx)("input",{type:"text",value:l.name,onChange:e=>n({...l,name:e.target.value}),placeholder:"Alex",className:"rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Relationship"}),(0,s.jsx)("input",{type:"text",value:l.relationship,onChange:e=>n({...l,relationship:e.target.value}),placeholder:"Partner, Friend, Therapist...",className:"rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"})]})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Preferred Contact Method"}),(0,s.jsxs)("select",{value:l.contactMethod,onChange:e=>n({...l,contactMethod:e.target.value}),className:"rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200",children:[(0,s.jsx)("option",{value:"sms",children:"Text Message"}),(0,s.jsx)("option",{value:"email",children:"Email"}),(0,s.jsx)("option",{value:"call",children:"Phone Call"})]})]}),(0,s.jsx)(a.FocusButton,{type:"button",variant:"secondary",onClick:()=>{l.name.trim()&&l.relationship.trim()&&e.supportCircle.length<5&&(i("supportCircle",[...e.supportCircle,{...l}]),n({name:"",relationship:"",contactMethod:"sms"}))},disabled:!l.name.trim()||!l.relationship.trim(),children:"Add Contact"})]}),0===e.supportCircle.length&&(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"You can skip this step and add contacts later."})]})}function u({formData:e,updateFormData:i}){let[l,n]=(0,t.useState)(""),[r,o]=(0,t.useState)(""),c=()=>{l.trim()&&(i("communicationGuidelines",{...e.communicationGuidelines,doPhrases:[...e.communicationGuidelines.doPhrases,l.trim()]}),n(""))},d=()=>{r.trim()&&(i("communicationGuidelines",{...e.communicationGuidelines,avoidPhrases:[...e.communicationGuidelines.avoidPhrases,r.trim()]}),o(""))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Communication Style"}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"Help us understand how you prefer to communicate during difficult moments."})]}),(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Communication Tone"}),(0,s.jsxs)("select",{value:e.communicationGuidelines.tone,onChange:s=>i("communicationGuidelines",{...e.communicationGuidelines,tone:s.target.value}),className:"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200",children:[(0,s.jsx)("option",{value:"soft",children:"Soft - Gentle, empathetic"}),(0,s.jsx)("option",{value:"direct",children:"Direct - Clear, straightforward"}),(0,s.jsx)("option",{value:"informative",children:"Informative - Factual, detailed"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Preferred Phrases"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&c(),placeholder:"e.g., 'I feel...', 'Could you help...'",className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"}),(0,s.jsx)(a.FocusButton,{type:"button",variant:"secondary",onClick:c,children:"Add"})]})]}),e.communicationGuidelines.doPhrases.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.communicationGuidelines.doPhrases.map((t,l)=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-indigo-100 px-3 py-1 text-sm text-indigo-700",children:[t,(0,s.jsx)("button",{type:"button",onClick:()=>{i("communicationGuidelines",{...e.communicationGuidelines,doPhrases:e.communicationGuidelines.doPhrases.filter((e,s)=>s!==l)})},className:"text-indigo-500 hover:text-indigo-700",children:"×"})]},l))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Avoid Phrases"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value),onKeyPress:e=>"Enter"===e.key&&d(),placeholder:"e.g., 'You always...', 'Why don't you...'",className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"}),(0,s.jsx)(a.FocusButton,{type:"button",variant:"secondary",onClick:d,children:"Add"})]})]}),e.communicationGuidelines.avoidPhrases.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.communicationGuidelines.avoidPhrases.map((t,l)=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-rose-100 px-3 py-1 text-sm text-rose-700",children:[t,(0,s.jsx)("button",{type:"button",onClick:()=>{i("communicationGuidelines",{...e.communicationGuidelines,avoidPhrases:e.communicationGuidelines.avoidPhrases.filter((e,s)=>s!==l)})},className:"text-rose-500 hover:text-rose-700",children:"×"})]},l))})]})]})]})}function h({formData:e,updateFormData:i}){let[l,n]=(0,t.useState)(""),[r,o]=(0,t.useState)(""),c=()=>{l.trim()&&(i("crisisSignals",{...e.crisisSignals,triggers:[...e.crisisSignals.triggers,l.trim()]}),n(""))},d=()=>{r.trim()&&(i("crisisSignals",{...e.crisisSignals,selfRegulationTechniques:[...e.crisisSignals.selfRegulationTechniques,r.trim()]}),o(""))};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Crisis Signals"}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"Help us understand your triggers and preferred self-regulation techniques."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Triggers"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:l,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&c(),placeholder:"e.g., Loud noises, Being rushed, Conflict",className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"}),(0,s.jsx)(a.FocusButton,{type:"button",variant:"secondary",onClick:c,children:"Add"})]})]}),e.crisisSignals.triggers.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.crisisSignals.triggers.map((t,l)=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-amber-100 px-3 py-1 text-sm text-amber-700",children:[t,(0,s.jsx)("button",{type:"button",onClick:()=>{i("crisisSignals",{...e.crisisSignals,triggers:e.crisisSignals.triggers.filter((e,s)=>s!==l)})},className:"text-amber-500 hover:text-amber-700",children:"×"})]},l))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"flex flex-col gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Self-Regulation Techniques"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:r,onChange:e=>o(e.target.value),onKeyPress:e=>"Enter"===e.key&&d(),placeholder:"e.g., Box breathing, Weighted blanket, Music",className:"flex-1 rounded-2xl border border-slate-200 bg-white px-4 py-2 text-sm text-slate-700 focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-200"}),(0,s.jsx)(a.FocusButton,{type:"button",variant:"secondary",onClick:d,children:"Add"})]})]}),e.crisisSignals.selfRegulationTechniques.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.crisisSignals.selfRegulationTechniques.map((t,l)=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-2 rounded-full bg-green-100 px-3 py-1 text-sm text-green-700",children:[t,(0,s.jsx)("button",{type:"button",onClick:()=>{i("crisisSignals",{...e.crisisSignals,selfRegulationTechniques:e.crisisSignals.selfRegulationTechniques.filter((e,s)=>s!==l)})},className:"text-green-500 hover:text-green-700",children:"×"})]},l))})]})]})]})}function p({formData:e}){return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold text-slate-900",children:"Review Your Profile"}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"Review your information before creating your profile."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900",children:"Preferred Name"}),(0,s.jsx)("p",{className:"mt-1 text-slate-600",children:e.preferredName})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900",children:"Support Circle"}),e.supportCircle.length>0?(0,s.jsx)("ul",{className:"mt-2 space-y-2",children:e.supportCircle.map((e,t)=>(0,s.jsxs)("li",{className:"text-slate-600",children:[e.name," (",e.relationship,") - ",e.contactMethod]},t))}):(0,s.jsx)("p",{className:"mt-1 text-slate-500",children:"No contacts added"})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900",children:"Communication Style"}),(0,s.jsxs)("p",{className:"mt-1 text-slate-600",children:["Tone: ",e.communicationGuidelines.tone]}),e.communicationGuidelines.doPhrases.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Preferred Phrases:"}),(0,s.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm text-slate-600",children:e.communicationGuidelines.doPhrases.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]}),e.communicationGuidelines.avoidPhrases.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Avoid Phrases:"}),(0,s.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm text-slate-600",children:e.communicationGuidelines.avoidPhrases.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})]}),(0,s.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900",children:"Crisis Signals"}),e.crisisSignals.triggers.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Triggers:"}),(0,s.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm text-slate-600",children:e.crisisSignals.triggers.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]}),e.crisisSignals.selfRegulationTechniques.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Self-Regulation Techniques:"}),(0,s.jsx)("ul",{className:"mt-1 list-inside list-disc text-sm text-slate-600",children:e.crisisSignals.selfRegulationTechniques.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})]})]})]})}function g(){let e,a=(0,i.useRouter)(),[n]=(0,t.useState)(((e=localStorage.getItem("meltdown_userId"))||(e=`user-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("meltdown_userId",e)),e)),[r,o]=(0,t.useState)(!0),[c,m]=(0,t.useState)(!1),[x,u]=(0,t.useState)(null);(0,t.useEffect)(()=>{h()},[n]);let h=async()=>{try{if(await (0,l.profileExists)(n)){let e=await (0,l.getProfileByUserId)(n);u(e),m(!0)}}catch(e){console.error("Failed to check profile:",e),m(!1)}finally{o(!1)}};return r?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"inline-block size-8 animate-spin rounded-full border-4 border-solid border-indigo-500 border-r-transparent"}),(0,s.jsx)("p",{className:"mt-4 text-slate-600",children:"Loading..."})]})}):c&&x?(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"mx-auto max-w-md rounded-4xl bg-white/80 p-8 shadow-2xl shadow-indigo-100 backdrop-blur-xl text-center",children:[(0,s.jsxs)("h1",{className:"text-2xl font-semibold text-slate-900",children:["Welcome back, ",x.preferredName,"!"]}),(0,s.jsx)("p",{className:"mt-2 text-slate-600",children:"You already have a profile set up."}),(0,s.jsx)("button",{onClick:()=>a.push("/"),className:"mt-6 rounded-full bg-indigo-500 px-6 py-3 text-white font-medium transition hover:bg-indigo-600",children:"Go to Translator"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-[#F3EEFF] via-white to-white py-12",children:(0,s.jsxs)("div",{className:"mx-auto max-w-4xl px-6",children:[(0,s.jsxs)("header",{className:"mb-8 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-semibold text-slate-900 sm:text-5xl",children:"Set Up Your Profile"}),(0,s.jsx)("p",{className:"mt-4 text-lg text-slate-600",children:"Let's create your personalized AI profile to get the most out of Meltdown Navigator."})]}),(0,s.jsx)(d,{userId:n,onComplete:e=>{u(e),m(!0),e._id&&localStorage.setItem("meltdown_profileId",e._id),a.push("/")}})]})})}e.s(["default",()=>g],90723)}]);